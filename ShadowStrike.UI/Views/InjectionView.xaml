<UserControl x:Class="ShadowStrike.UI.Views.InjectionView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="800" d:DesignWidth="1200">

    <Grid Background="#0D1117">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="400" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- LEFT COLUMN: Controls & Configuration -->
        <Border Grid.Column="0" Background="#161B22" BorderBrush="#30363D" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="20">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <materialDesign:PackIcon Kind="ShieldAlert" Width="32" Height="32"
                            Foreground="White" Margin="0,0,15,0" VerticalAlignment="Center" />
                        <TextBlock Text="Injection Testing" FontSize="24" FontWeight="Light"
                            Foreground="White" VerticalAlignment="Center" />
                    </StackPanel>

                    <!-- SQL Injection Section -->
                    <Expander IsExpanded="True" Background="Transparent" BorderBrush="#30363D"
                        BorderThickness="0,0,0,1">
                        <Expander.Header>
                            <TextBlock Text="SQL INJECTION" FontWeight="Bold" Foreground="#58A6FF" />
                        </Expander.Header>
                        <StackPanel Margin="0,10,0,10">
                            <TextBox x:Name="SqliTargetUrlInput"
                                materialDesign:HintAssist.Hint="Target URL"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <TextBox x:Name="SqliParameterInput"
                                materialDesign:HintAssist.Hint="Parameter (e.g., id)"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <Button x:Name="TestSqlInjectionBtn" Content="SCAN VULNERABILITIES"
                                Click="TestSqlInjection_Click" Margin="0,0,0,8"
                                Background="#1F6FEB" BorderThickness="0" />
                            <Button x:Name="SqliDumpDataBtn" Content="DUMP DATABASE"
                                Click="SqliDumpData_Click" Margin="0,0,0,8"
                                Background="#D29922" BorderThickness="0" Foreground="Black" />
                            <Button x:Name="SqliAuthBypassBtn" Content="AUTH BYPASS"
                                Click="SqliAuthBypass_Click" Margin="0,0,0,8"
                                Background="#DA3633" BorderThickness="0" />
                        </StackPanel>
                    </Expander>

                    <!-- XSS Section -->
                    <Expander IsExpanded="False" Background="Transparent" BorderBrush="#30363D"
                        BorderThickness="0,0,0,1">
                        <Expander.Header>
                            <TextBlock Text="XSS ATTACK" FontWeight="Bold" Foreground="#8957E5" />
                        </Expander.Header>
                        <StackPanel Margin="0,10,0,10">
                            <TextBox x:Name="XssTargetUrlInput"
                                materialDesign:HintAssist.Hint="Target URL"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <TextBox x:Name="XssParameterInput"
                                materialDesign:HintAssist.Hint="Parameter (e.g., q)"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <TextBox x:Name="BeefHookInput"
                                materialDesign:HintAssist.Hint="BeEF Hook URL (Optional)"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <TextBox x:Name="AttackerServerInput"
                                materialDesign:HintAssist.Hint="Attacker Server (Optional)"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <Button x:Name="TestXssBtn" Content="SCAN &amp; GENERATE PAYLOADS"
                                Click="TestXss_Click" Margin="0,0,0,8"
                                Background="#8957E5" BorderThickness="0" />
                            <Button x:Name="XssBrowserTestBtn" Content="OPEN IN BROWSER"
                                Click="XssBrowserTest_Click" Margin="0,0,0,8"
                                Background="#238636" BorderThickness="0" />
                        </StackPanel>
                    </Expander>

                    <!-- File Upload Section -->
                    <Expander IsExpanded="False" Background="Transparent" BorderBrush="#30363D"
                        BorderThickness="0,0,0,1">
                        <Expander.Header>
                            <TextBlock Text="FILE UPLOAD" FontWeight="Bold" Foreground="#238636" />
                        </Expander.Header>
                        <StackPanel Margin="0,10,0,10">
                            <TextBox x:Name="UploadTargetUrlInput"
                                materialDesign:HintAssist.Hint="Upload URL"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Foreground="White" Margin="0,0,0,15" />
                            <DockPanel Margin="0,0,0,15">
                                <Button x:Name="BrowseFileBtn" Content="..." Width="40"
                                    Click="BrowseFile_Click" DockPanel.Dock="Right" Margin="5,0,0,0"
                                    Style="{StaticResource MaterialDesignOutlinedButton}" />
                                <TextBox x:Name="FilePathInput"
                                    materialDesign:HintAssist.Hint="File to Upload"
                                    Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                    Foreground="White" IsReadOnly="True" />
                            </DockPanel>
                            <CheckBox x:Name="BrowserModeCheckbox"
                                Content="Use Browser Mode" Foreground="#8B949E" Margin="0,0,0,15" />
                            <Button x:Name="TestFileUploadBtn" Content="TEST UPLOAD"
                                Click="TestFileUpload_Click" Margin="0,0,0,8"
                                Background="#238636" BorderThickness="0" />
                            <Button x:Name="UploadShellBtn" Content="UPLOAD WEB SHELL"
                                Click="UploadShell_Click" Margin="0,0,0,8"
                                Background="#DA3633" BorderThickness="0" FontWeight="Bold" />
                        </StackPanel>
                    </Expander>

                    <!-- Stats -->
                    <Grid Margin="0,20,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Background="#21262D" CornerRadius="5" Padding="10"
                            Margin="0,0,5,0">
                            <StackPanel>
                                <TextBlock Text="TESTS" Foreground="#8B949E" FontSize="10" />
                                <TextBlock x:Name="TestsRunText" Text="0" Foreground="White"
                                    FontSize="20" FontWeight="Bold" />
                            </StackPanel>
                        </Border>
                        <Border Grid.Column="1" Background="#21262D" CornerRadius="5" Padding="10"
                            Margin="5,0,0,0">
                            <StackPanel>
                                <TextBlock Text="VULNERABILITIES" Foreground="#8B949E" FontSize="10" />
                                <TextBlock x:Name="VulnerabilitiesText" Text="0"
                                    Foreground="#FF7B72" FontSize="20" FontWeight="Bold" />
                            </StackPanel>
                        </Border>
                    </Grid>

                    <Border Background="#21262D" CornerRadius="5" Padding="10" Margin="0,10,0,0">
                        <StackPanel>
                            <TextBlock Text="STATUS" Foreground="#8B949E" FontSize="10" />
                            <TextBlock x:Name="StatusText" Text="READY" Foreground="#3FB950"
                                FontSize="16" FontWeight="Bold" />
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- RIGHT COLUMN: Results DataGrid -->
        <Grid Grid.Column="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <TextBlock Text="TEST RESULTS" FontWeight="Bold" Foreground="#58A6FF" Margin="0,0,0,10" />

            <DataGrid Grid.Row="1"
                x:Name="ResultsGrid"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                HeadersVisibility="Column"
                Background="#0D1117"
                RowBackground="#161B22"
                AlternatingRowBackground="#0D1117"
                Foreground="#C9D1D9"
                BorderBrush="#30363D"
                BorderThickness="1"
                GridLinesVisibility="Horizontal"
                HorizontalGridLinesBrush="#30363D">
                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#21262D" />
                        <Setter Property="Foreground" Value="#8B949E" />
                        <Setter Property="Padding" Value="10,5" />
                        <Setter Property="FontWeight" Value="Bold" />
                        <Setter Property="BorderThickness" Value="0,0,0,1" />
                        <Setter Property="BorderBrush" Value="#30363D" />
                    </Style>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="10" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Background="{TemplateBinding Background}"
                                        SnapsToDevicePixels="True">
                                        <ContentPresenter
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="TEST NAME" Binding="{Binding TestName}" Width="200"
                        FontWeight="Bold" />
                    <DataGridTextColumn Header="TYPE" Binding="{Binding Type}" Width="100" />
                    <DataGridTemplateColumn Header="STATUS" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border Background="{Binding StatusColor}" CornerRadius="3"
                                    Padding="8,2">
                                    <TextBlock Text="{Binding Status}" Foreground="White"
                                        HorizontalAlignment="Center" FontWeight="Bold" />
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="SEVERITY" Binding="{Binding Severity}" Width="100" />
                    <DataGridTextColumn Header="DETAILS / PAYLOAD" Binding="{Binding Details}"
                        Width="*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Mitigation Panel -->
            <Border Grid.Row="2" Background="#161B22" BorderBrush="#D29922" BorderThickness="1"
                CornerRadius="5" Padding="15" Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="MITIGATION GUIDANCE" FontWeight="Bold" Foreground="#D29922"
                        Margin="0,0,0,5" />
                    <TextBlock x:Name="MitigationText"
                        Text="Select a test to view specific mitigation details."
                        Foreground="#8B949E"
                        TextWrapping="Wrap" />
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>